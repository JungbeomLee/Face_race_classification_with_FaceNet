import tensorflow as tf
import mediapipe as mp
import cv2
import numpy as np

class face_fair_check() :
    def __init__(self, model_path:str) :
        self.Caucasian_Northern_European_male_mean_vector = np.array([-7.1301365e-01,  3.8644940e-02, -5.8139795e-01,  3.0470219e-01,
            4.2391461e-01,  3.0218628e-01,  1.9487281e-01, -1.9189427e-02,
            1.3655332e-01,  2.2675855e-01,  8.5275018e-01, -1.2626003e+00,
           -1.7310400e-02, -1.3634305e-01,  2.2800265e-01, -2.8451553e-01,
           -4.0234616e-01, -7.8165811e-01, -1.1635255e+00,  3.9609265e-01,
            9.7196758e-01, -3.4850779e-01,  6.3888091e-01, -1.0300308e+00,
           -1.9072641e-02, -3.3671024e-01, -2.1994621e-01,  1.5134235e-01,
           -7.2733504e-01,  2.2295398e-01, -2.1875100e-01, -4.9909371e-01,
            4.3901414e-02,  4.6787366e-01,  9.8354226e-01,  1.4476632e+00,
           -4.4619963e-01,  8.3480641e-02,  1.6437581e-01, -4.8351884e-01,
            1.6322663e-01,  2.0871229e+00, -8.6344731e-01, -8.2575274e-01,
           -2.8792748e-01, -1.1518112e+00,  5.5709565e-01,  1.3163922e+00,
           -1.3976470e-01,  8.9161772e-01, -1.5929359e+00,  9.6693218e-01,
           -2.6640949e-01,  3.5970706e-01, -4.0471727e-01,  4.5091900e-01,
            6.6429472e-01,  5.3957975e-01,  1.7703192e-01, -8.3309673e-02,
            5.3894520e-01,  3.1043801e-01, -4.8833299e-02,  1.4022595e+00,
            6.7299759e-01,  1.7116389e-01, -7.9391110e-01,  1.6887356e+00,
            6.1746585e-01,  4.9663457e-01, -5.6710339e-01,  3.0963337e-01,
           -8.3046311e-01, -7.6886916e-01, -8.4786139e-02,  3.4538928e-01,
            2.6950397e-04, -4.8785982e-01, -1.0196115e+00,  2.0722311e-02,
           -7.1453601e-01, -7.4627000e-01,  6.8488359e-01,  9.4091648e-01,
            1.0812272e+00, -5.1862597e-02,  1.1163841e+00,  1.6331430e-01,
           -8.1437510e-01, -5.3771955e-01,  4.7504589e-02,  6.3898033e-01,
            6.9399858e-01,  8.5280049e-01, -2.6669922e-01,  1.0092262e+00,
           -1.3776875e+00, -6.3237047e-01, -7.4434739e-01,  5.8126575e-01,
           -1.7557190e-01,  8.5796851e-01, -1.2797391e+00, -5.5791599e-01,
            8.7731481e-01, -1.4930983e-01, -1.4895149e-01, -4.6523556e-01,
            4.5462924e-01, -1.7657761e-02,  6.3573843e-01, -9.6088040e-01,
           -4.0074813e-01,  1.7760521e+00, -3.3551398e-01,  1.2645664e+00,
           -4.4173622e-01, -3.2783109e-01,  2.2605687e-01,  1.1179712e+00,
            7.7448702e-01,  5.1924682e-01, -3.1237456e-01, -1.1770264e+00,
            1.3936219e-01, -1.4412330e+00,  7.9872090e-01,  4.1503963e-01],
          dtype='float32')
        
        self.Caucasian_Northern_European_female_mean_vector = np.array([-0.5754751 , -0.22521298,  0.31502286, -0.5270557 ,  1.0502431 ,
            -0.35130346,  0.5155386 , -0.12832445,  0.4374434 , -0.08344769,
                1.4429517 , -0.2632347 , -0.73895293, -0.32653475,  0.71683866,
                0.451773  , -0.23878038, -0.3876118 , -0.8944066 , -0.6878344 ,
                0.12159432, -1.4559889 ,  0.624349  , -0.7807037 , -0.3035625 ,
                0.35638243,  0.21970005, -0.32529882, -0.24423508,  0.33404636,
                0.9388088 , -1.6584213 ,  0.54842997,  0.8674513 ,  0.6101693 ,
                1.4625384 , -0.7700795 ,  1.1480485 , -0.0841903 , -0.5834143 ,
            -0.5942926 ,  0.9817275 , -0.6233642 ,  0.12612382, -0.7803637 ,
            -0.7401626 , -0.13058603,  1.0552685 , -0.08050977,  0.12204219,
            -0.66134584,  0.76380646, -0.55868185,  0.6269578 ,  0.82987815,
                1.316596  ,  0.81541187,  0.7858285 ,  0.363107  ,  0.6147782 ,
                0.18665288,  1.0165133 , -0.41709137,  1.6087046 ,  1.3371532 ,
                1.0144142 , -2.0962346 ,  0.84879315, -0.11989671,  2.5269415 ,
                0.3380991 , -0.22158828, -0.7252239 , -0.32259998,  0.06527747,
                0.7405222 , -1.0741765 , -0.79831123, -1.4029622 ,  0.14894749,
            -1.0648425 , -0.21520631,  1.6157783 ,  0.79794824,  1.2553883 ,
            -0.57285345,  0.8253274 ,  0.57265204, -0.52119863, -0.8941491 ,
            -0.7245108 , -0.22841558,  0.75434834, -0.3550243 , -0.0571363 ,
                0.5544346 , -1.5344563 , -0.21629651,  0.07993449,  0.15634492,
            -0.74927115, -0.16221356, -1.456271  ,  1.0322573 ,  1.8958782 ,
                0.5678046 ,  0.4237927 ,  0.39536852,  0.92737275, -0.3500567 ,
                0.746249  , -1.1501129 , -0.7848753 ,  0.89598435, -0.1477181 ,
                1.2135394 ,  0.46546513,  0.07806923,  0.6446332 , -0.85016316,
                2.6020277 ,  0.36452928, -0.19275168, -1.1820254 , -0.31890568,
            -1.754599  , -0.21744761, -0.11971392], dtype='float32')
        self.Caucasian_Semitic_male_mean_vector = np.array([-1.5679473 , -0.7234924 , -0.02484678,  0.36776736,  0.87561285,
            -0.10673892, -0.28958184,  0.27509743,  1.056334  ,  0.16069743,
                0.2236085 , -2.3562195 ,  0.63128173, -0.42018825, -0.44146657,
                0.64569384,  0.2397809 ,  0.37357843, -0.48808327, -1.0245184 ,
            -0.07354623, -0.06962998,  0.9897971 ,  0.25708526,  0.00525602,
                0.03373262, -0.04569099,  0.26099658, -0.7570914 , -0.01868192,
            -0.841272  , -0.47960886,  0.24928696, -0.60186535,  1.9469059 ,
                1.0202161 , -0.01787535,  0.9476906 ,  0.04819567,  0.37871417,
                0.93241006,  0.92477876,  1.2856205 ,  0.2889613 ,  0.7414555 ,
            -1.2041467 ,  0.8553735 ,  0.08973695,  0.7110938 ,  0.26322532,
            -0.61615205,  1.5615585 , -0.8443147 , -0.15461174, -1.0753658 ,
                0.52453595,  0.8137888 , -0.6096014 , -0.7114784 ,  1.2574667 ,
                1.6346931 ,  0.09030615, -0.23460858,  1.0150684 ,  0.06416815,
                0.520869  ,  0.28604662,  1.8256353 ,  1.5698763 , -0.4245    ,
            -0.90283644,  0.50437033, -1.2218857 , -0.8760327 ,  0.8781419 ,
                0.15297414, -0.88356686, -0.6985092 , -0.96761096, -1.1558739 ,
                0.5116296 ,  0.94646084,  1.2035625 ,  0.8804194 , -0.36910108,
            -0.22956204,  1.1346183 , -0.22429891, -1.7918164 ,  0.23717172,
            -0.56928205,  0.6388845 ,  1.1665136 ,  1.161273  , -1.1819897 ,
                1.3820364 , -2.313882  ,  0.11212208, -1.2874403 ,  1.389694  ,
                0.12350269,  0.15718175, -1.1210346 , -1.1871828 ,  0.09898514,
            -0.8426571 , -2.1899192 ,  0.3110089 , -0.86718094, -0.44695416,
                0.2131429 , -0.24016435,  0.43846464,  1.4245536 , -1.3247215 ,
                0.11422984,  0.3906111 , -1.1722906 , -0.87207204,  1.0997672 ,
                0.9629647 , -0.80698216, -0.22136763, -0.33065805,  0.05285671,
            -1.0803027 ,  0.8493088 , -0.5256971 ], dtype='float32')
        self.Caucasian_Semitic_female_mean_vector = np.array([-1.64142609e+00, -3.67824525e-01,  3.12749267e-01,  2.05970362e-01,
                1.48023665e+00, -1.05860981e-03,  6.60514712e-01,  3.22883166e-02,
                8.58095944e-01, -1.06228411e+00,  2.59822048e-02, -7.26205707e-01,
                9.15492654e-01, -3.52844179e-01, -4.29816917e-02,  6.65490150e-01,
            -2.05012769e-01, -1.81867734e-01, -5.25161386e-01, -1.83262277e+00,
                6.57110885e-02, -8.35346699e-01,  9.19504762e-01, -5.15764773e-01,
            -1.04163516e+00, -5.97334802e-02,  2.94953883e-01,  4.52963650e-01,
            -4.87282991e-01,  6.17455959e-01, -3.38619977e-01, -1.83588827e+00,
                7.28290677e-01, -2.45846622e-02,  1.52290082e+00,  4.09013361e-01,
            -1.05038010e-01,  1.22925687e+00, -1.28093541e-01,  7.08829761e-01,
                3.83692086e-01,  5.16219974e-01,  5.46960235e-01, -1.16725937e-01,
            -9.09921348e-01, -2.39388898e-01,  4.76408899e-01, -2.42403150e-01,
                2.69110911e-02, -1.36478543e-01, -1.31910110e+00,  1.91369605e+00,
            -2.98724860e-01, -3.45948189e-01,  4.99878079e-01,  2.10513544e+00,
                5.53954661e-01,  4.79715407e-01,  2.07994610e-01,  6.18086636e-01,
                5.24758101e-01,  6.08883977e-01, -5.30376792e-01,  1.54055774e+00,
            -3.85710418e-01,  1.19778466e+00, -9.87504184e-01,  1.47095275e+00,
                4.42277282e-01,  6.90954924e-01,  1.04800439e+00,  3.45853269e-01,
            -4.27908823e-02, -5.45740485e-01,  7.82217085e-01,  1.54079378e+00,
            -6.36344850e-01,  3.11453342e-01, -1.47865474e+00, -1.01425195e+00,
            -6.54950738e-01,  7.91759431e-01,  1.12629604e+00,  3.67986143e-01,
                9.35660183e-01, -5.28260052e-01,  1.25032198e+00,  3.48658748e-02,
            -1.43456614e+00,  1.04301915e-01, -9.20361996e-01, -1.80465192e-01,
                1.11635089e+00, -2.31580399e-02, -8.07394981e-01,  1.26285303e+00,
            -2.13797474e+00,  6.07906990e-02, -5.47402620e-01,  6.47608161e-01,
            -3.82506669e-01,  3.89910877e-01, -5.14286160e-01,  1.77889496e-01,
                1.13088965e+00, -4.07185793e-01, -2.65101433e-01,  2.60059953e-01,
            -1.00214675e-01, -4.44129944e-01,  1.05536604e+00, -4.43378836e-03,
            -3.66256207e-01,  1.31105530e+00, -1.14111018e+00,  9.48806107e-01,
                7.81275868e-01,  2.45715499e-01, -4.75916624e-01, -2.45656520e-01,
                2.10223126e+00,  5.41354436e-03,  2.55972385e-01, -1.13213944e+00,
            -6.23341441e-01, -5.95321596e-01,  2.78092295e-01, -2.10588187e-01],
            dtype='float32')
        self.Caucasian_Southern_European_male_mean_vector = np.array([-9.99162555e-01, -1.62585095e-01, -3.50408942e-01,  8.32211018e-01,
                4.81563002e-01, -2.12397188e-01, -1.03191897e-01, -7.54094347e-02,
                5.19856036e-01, -2.12918082e-03,  1.66914389e-01, -2.46138000e+00,
                3.24805081e-02, -1.05025268e+00,  5.64741492e-01,  3.01409572e-01,
            -1.19876049e-01, -3.12366197e-03, -1.55016625e+00,  2.09655240e-01,
                1.05816579e+00,  4.00834065e-03,  8.42850387e-01, -6.40500009e-01,
            -3.43192518e-01, -1.37112021e-01, -1.18228018e+00,  5.23520827e-01,
                4.89094347e-01,  4.30717528e-01, -6.29614592e-01, -5.40426254e-01,
            -1.13697074e-01,  1.26042634e-01,  1.61410546e+00,  1.60867906e+00,
            -1.10521019e+00,  1.00727582e+00, -9.13892627e-01, -1.83323815e-01,
                1.25604880e+00,  2.19835997e+00,  4.98992354e-01, -3.21226776e-01,
                7.01524913e-01, -1.35282624e+00,  1.72156560e+00,  9.70008552e-01,
            -4.02261585e-01,  4.98640686e-01, -1.21435034e+00,  1.09650779e+00,
            -9.82921779e-01,  7.03856230e-01, -1.20706296e+00,  2.23382875e-01,
                2.75550991e-01,  1.59613825e-02,  2.46555045e-01,  1.09807241e+00,
                1.39785337e+00, -1.12818703e-01, -6.27043724e-01,  1.12196112e+00,
                8.63922834e-02,  6.14950478e-01,  1.68250114e-01,  2.41259146e+00,
                1.55669427e+00, -1.61211818e-01, -1.48072338e+00,  5.57109490e-02,
            -9.77080941e-01, -1.14688993e+00,  2.38203187e-03,  1.03989911e+00,
            -5.03149688e-01, -1.06761754e+00, -1.36868823e+00, -8.77861500e-01,
                1.28791600e-01,  3.20834443e-02,  6.70317531e-01,  8.32979500e-01,
                2.13448733e-01, -1.15012932e+00,  1.78765965e+00, -1.87991828e-01,
            -9.94391143e-01, -2.33665079e-01, -4.36887175e-01,  8.38237286e-01,
                1.44088078e+00,  9.00610328e-01, -1.47603059e+00,  4.77633387e-01,
            -2.17509508e+00, -4.64631736e-01, -7.65660584e-01,  1.48979354e+00,
                8.81512910e-02,  3.33219945e-01, -2.11789823e+00, -2.06294969e-01,
                1.17074811e+00, -2.70039827e-01, -1.12196040e+00, -8.77631605e-02,
            -7.60517716e-02,  9.48104680e-01,  4.28372294e-01, -6.19600654e-01,
            -4.05262649e-01,  1.85385394e+00, -1.30307698e+00,  1.53716534e-01,
            -8.61901581e-01, -1.88506186e+00, -5.68501532e-01,  7.51623273e-01,
                1.62149882e+00,  5.23235440e-01, -9.77477252e-01, -5.98480225e-01,
                4.20288175e-01, -1.42954612e+00,  8.62796485e-01,  1.13759913e-01],
            dtype='float32')
        self.Caucasian_Southern_European_female_mean_vector = np.array([-0.30495185, -0.25839335,  0.49313045, -0.00360712,  0.8211535 ,
        -0.23175678,  0.6767324 , -0.01681672,  0.7778069 , -0.11339052,
            0.63312876, -0.57587564, -0.11187017,  0.01910544,  0.29433253,
            0.57798064, -0.41882858, -0.15532725, -0.5128859 , -0.77946186,
            0.14526606, -1.0087581 ,  0.69191426, -0.50941044, -0.5936137 ,
            0.47976747,  0.50591546, -0.39583024,  0.25984743,  0.6172535 ,
            0.6858594 , -1.5691961 ,  0.77185524,  0.34391862,  0.51316047,
            0.9642221 , -0.7197509 ,  1.2362697 , -0.65806514,  0.10763662,
        -0.30251804,  0.7204486 ,  0.14925502,  0.11047818, -0.7826142 ,
        -0.121602  ,  0.01526315,  0.5006752 , -0.10310066, -0.26957092,
        -0.65791374,  1.1669369 , -0.9771531 ,  0.4463252 ,  0.62976205,
            1.6646271 ,  0.5694852 ,  1.0610819 ,  0.46687523,  0.6455239 ,
            0.25728607,  1.3532765 , -0.5115557 ,  1.7841518 ,  0.7461635 ,
            1.1687438 , -1.6203455 ,  1.2731854 , -0.03998088,  2.081785  ,
            0.600829  , -0.2479538 ,  0.21282327, -0.43454638,  0.48614544,
            1.0098536 , -1.0217875 , -0.67558074, -1.7964672 , -0.333769  ,
        -0.8002116 ,  0.07424353,  1.685194  ,  0.50642717,  0.92653924,
        -0.92908347,  0.52625215,  0.38012475, -0.48303428, -1.1097952 ,
        -0.8269119 , -0.19148234,  1.0982677 , -0.4929754 , -0.3851038 ,
            0.58474123, -1.7140261 ,  0.00889302,  0.12146091,  0.06706051,
        -0.77502835,  0.3327194 , -1.0602587 ,  0.7587105 ,  1.7438333 ,
            0.11198983,  0.45748788,  0.83616227,  0.7508751 , -0.4387815 ,
            0.8851782 , -0.76643986, -0.909115  ,  0.9622771 , -0.5785402 ,
            1.2517548 ,  0.71197397,  0.15538535,  0.18767431, -0.918615  ,
            2.7381463 ,  0.43671384, -0.15210529, -1.2245288 , -0.13787542,
        -1.5389612 , -0.25611264,  0.06689279], dtype='float32')
        self.Caucasian_West_Asian_male_mean_vector = np.array([ 1.3234963e-01, -4.9404430e-01, -2.2329888e+00, -4.5016956e-01,
                1.3671567e+00, -1.1510618e+00, -1.6061907e-01,  1.3146712e-01,
            -9.9163890e-02,  1.2418697e-01, -1.3112999e-01, -1.8259809e+00,
            -1.2601402e+00, -7.7527088e-01,  4.2867947e-01,  1.0521010e+00,
                5.6344628e-01, -1.0436910e+00, -4.9327749e-01, -1.3396318e+00,
            -6.0264993e-02,  9.7915351e-01, -6.0599244e-01, -5.4214293e-01,
                6.0515207e-01, -4.4790593e-01, -3.8504153e-01,  3.1225261e-01,
                5.8482815e-02,  1.3537395e+00,  6.2799835e-01, -6.1718982e-01,
                7.0437312e-01, -4.6747547e-01,  7.7887553e-01,  2.5305420e-01,
            -2.8457454e-01,  6.3368720e-01,  5.9147823e-01, -6.7495507e-01,
            -8.3254111e-01,  9.8385286e-01, -4.7769538e-01, -5.0581610e-01,
            -3.8957351e-01, -8.4498155e-01, -3.5020727e-01,  2.7368516e-01,
            -3.1703836e-01,  1.1574953e+00, -3.4625068e-01,  1.1075847e+00,
                6.7807066e-01, -1.5196227e+00, -4.7328115e-01,  3.3567458e-01,
                8.1996125e-01, -2.5359636e-02,  7.1039206e-01, -5.4161787e-01,
            -4.8777324e-01, -8.6618519e-01, -5.4223949e-01,  2.0123351e+00,
                6.4960212e-01, -3.4977227e-01,  7.2051123e-02, -1.9126909e-03,
                2.5414357e-01, -1.1636578e+00,  4.3905503e-01, -1.4427351e+00,
            -1.3652523e+00, -2.3388951e+00,  5.7131422e-01,  9.2402828e-01,
                2.7379504e-01,  8.8294393e-01, -9.5082152e-01, -1.1923828e+00,
            -7.5881767e-01,  1.4036083e+00, -1.1415038e-01,  6.7880774e-01,
                5.6055534e-01, -1.1305063e+00, -5.9515876e-01, -4.0778798e-01,
            -1.8441327e+00,  3.9823708e-01,  7.7977782e-01,  3.4379154e-03,
            -5.1937830e-01,  1.0424976e+00, -6.8471998e-01, -6.6357160e-01,
            -1.4121753e+00, -8.2617062e-01, -1.2701705e+00,  8.4488297e-01,
            -1.3149966e-01,  3.6097324e-01,  2.7353686e-01, -8.2072037e-01,
            -4.3107766e-01, -3.6648050e-01, -2.9731897e-01,  6.0762931e-02,
            -7.7960527e-01,  1.2101279e-01, -4.7594093e-02,  3.6280382e-01,
                2.4824345e-01,  1.7679980e+00,  7.9220939e-01, -6.8485558e-01,
                9.9350965e-01, -3.3575132e-01, -1.0076988e+00,  1.7716528e+00,
                2.1714127e+00, -1.4910211e-01, -4.3360883e-01, -3.0428213e-01,
            -1.5254422e-01, -2.1361547e+00, -2.9233930e-01, -6.9530451e-01],
            dtype='float32')
        self.Caucasian_West_Asian_female_mean_vector = np.array([-0.95863926, -1.296976  , -0.54489225, -0.7171648 , -0.46633664,
            -0.5551365 , -0.48187953, -0.04742701, -1.3575342 ,  0.3122911 ,
                0.3877051 , -0.95927   , -1.237183  ,  0.9143888 ,  0.19221035,
                0.75909674,  1.1432732 , -1.6111867 ,  1.236676  , -0.72200876,
            -0.622063  , -0.7609201 , -0.87746257, -0.18014786,  0.3694492 ,
            -0.02259878, -0.8275816 ,  0.35831854,  0.97304523,  0.5267793 ,
            -0.02636945, -1.1772546 , -0.4365654 , -0.07428638,  1.3326589 ,
                1.4182498 , -1.0051754 ,  1.6163826 ,  1.2245243 , -0.13475409,
                0.32903507,  0.81245947, -0.6942653 ,  0.4352942 ,  0.08539261,
            -0.75437105, -0.40425467,  1.0664208 , -0.7531813 ,  0.37133896,
            -0.9759613 ,  1.860569  ,  0.92517966, -1.1807181 , -0.67021286,
                0.58160865,  0.8952428 ,  0.47705293,  1.8207258 ,  0.7382349 ,
                0.8274519 ,  0.07203394, -0.8894803 ,  0.56619793, -0.4390468 ,
                0.45886475,  0.30550593,  0.2685722 ,  0.39250383,  0.2144018 ,
            -0.25882694, -0.5601448 , -1.3959122 , -1.0019114 , -0.1444732 ,
                1.7369225 ,  0.5903346 , -0.10150331, -0.4525877 , -0.44459352,
            -0.4603765 ,  0.441995  , -0.98220444, -0.53730285,  1.2680452 ,
            -2.0852191 , -0.23668365,  0.42073464, -1.4663982 ,  0.09273188,
            -0.16026023,  0.07741783,  0.3234514 ,  1.3025268 , -0.5503393 ,
            -0.960221  , -0.29964224,  0.44742727, -0.65459675,  1.2950144 ,
                0.72926676, -0.2810026 , -0.0248318 ,  0.20745988,  0.15244217,
                0.42570966,  0.91291726,  0.16781817, -0.7460127 , -0.29526904,
                1.3847188 ,  0.13170782,  0.6973794 ,  0.2635065 , -0.5153305 ,
            -0.9203671 ,  1.5443922 ,  0.3174265 , -0.8776452 ,  1.7081693 ,
                2.074103  ,  1.1850741 , -0.91224176, -0.931471  ,  0.46845245,
            -0.5770484 ,  0.55856985, -0.8496841 ], dtype='float32')
        
        self.Mongoloid_Central_Asian_male_mean_vector = np.array([-0.49070874,  0.2259645 , -1.5157535 , -0.3349877 ,  1.8090614 ,
                0.23486736, -0.28566945,  0.8994857 ,  0.4550739 ,  0.11922465,
            -0.61909294, -1.5293367 , -1.5386823 ,  0.3520088 ,  0.13033101,
            -0.07939968, -0.40448913, -1.5758545 , -1.3019423 , -1.0927284 ,
                0.5990912 ,  0.9623377 , -1.1823609 , -1.0567262 ,  0.36114448,
            -1.3507581 , -0.40367192,  0.28744242, -0.553866  ,  0.71821344,
                0.5354446 , -0.8549339 , -0.1914222 , -0.10751469,  0.58552396,
                0.04307244, -0.42024994, -1.2693689 ,  0.16726522, -1.1367592 ,
            -1.0619297 ,  0.16701324, -1.8121269 , -0.43801755, -0.24564096,
            -1.8146235 , -0.00437675,  0.980855  , -0.09627283,  1.1907439 ,
            -2.4664536 ,  2.2109447 , -0.08427982, -0.14909244, -0.7071073 ,
                0.05541351,  1.1277018 , -1.4028213 , -0.23607063,  0.5780868 ,
            -0.8436936 , -0.45840374,  1.1416129 ,  1.7165282 ,  0.560387  ,
                0.3267637 , -0.4970212 ,  1.4842477 , -0.22628006, -0.43740553,
            -0.23733027, -0.3385698 , -1.3419795 , -2.1516845 ,  0.6620429 ,
                0.2458452 ,  0.2988963 , -0.16481133, -0.6995419 ,  0.45565477,
            -1.0832975 ,  0.4063558 ,  0.50117767,  0.79353404,  1.1528189 ,
            -0.57026803, -1.330819  , -0.45985594, -0.24678688,  0.04114587,
                0.76361203, -0.6577145 , -0.6081439 ,  0.16529983,  0.00692168,
                0.45902687, -1.9679937 , -0.14206704, -0.17061248,  1.0925651 ,
                0.57062864,  0.98292416, -0.789903  ,  0.07236806,  0.62976766,
            -0.02362568, -0.86189336, -0.4240826 , -0.30141422, -0.04656404,
            -0.03633507, -0.76508653, -0.02903632,  1.3531022 ,  0.5775467 ,
            -0.66383183,  0.43626308,  0.3126683 , -0.5400219 ,  1.4081075 ,
                2.0813177 ,  0.5429203 , -0.48437318, -0.67759067, -0.29374957,
            -1.7096605 ,  0.00865528,  0.5188166 ], dtype='float32')
        self.Mongoloid_Central_Asian_female_mean_vector = np.array([-1.4361749 , -0.5422189 , -0.10322207, -1.3137857 ,  0.91310674,
            -0.34006262,  0.2688473 ,  0.80918616,  0.13796076,  0.18910041,
            -0.30578333,  0.04176112, -0.99612826,  0.796297  ,  0.3073946 ,
                0.541578  ,  0.43614307, -2.30013   , -0.00927086, -2.021501  ,
            -0.18945575, -0.5859848 , -0.93699294, -0.5540994 , -0.27809316,
            -0.49685365,  0.4002363 ,  0.4515864 , -0.5504743 ,  0.9998657 ,
            -0.07080647, -1.6454388 , -0.12687562,  0.42862862,  1.2370309 ,
                0.44417042, -0.657986  ,  0.12824972,  0.7437829 , -1.0878465 ,
            -0.6115817 ,  0.880805  , -1.2992151 ,  0.2301569 , -0.23699026,
            -1.1367569 , -0.38353074,  0.19277948, -0.16835806,  1.1063879 ,
            -2.0093815 ,  2.2365901 ,  0.7445692 , -1.373836  , -0.09382323,
                0.33396325,  1.0548031 , -0.3641205 ,  0.74948215,  0.5998986 ,
            -0.30742055,  0.73987275,  0.40840998,  1.2220755 ,  0.08587005,
                0.7061305 , -1.3103098 ,  1.2940491 , -0.10468926,  1.0550272 ,
                0.45902696,  0.2312521 , -1.1472392 , -2.0875673 ,  0.04713868,
                0.7047295 , -0.20971437, -0.52330416, -0.11205995, -0.47261387,
            -1.1316679 ,  0.44304314,  0.29763338, -0.31277424,  0.91204435,
            -1.1508805 , -0.04579798,  0.47756276, -1.1538833 ,  0.12994884,
            -0.26698083, -0.28745946, -0.13116059,  0.5884659 ,  0.64196557,
            -0.00858704, -1.0904363 ,  0.75505275, -0.18026285,  1.8879135 ,
                1.3537829 ,  0.4472639 , -0.70472115,  0.5742318 ,  0.6630925 ,
                0.7266723 , -0.3885272 , -0.36650255, -1.1640842 , -0.02749904,
                1.0005057 , -0.77666074,  0.47019964,  1.1109703 , -0.22478954,
            -0.26165372,  0.9248699 ,  0.700657  ,  0.08488981,  0.59700555,
                2.4049008 ,  0.8200989 , -0.50148726, -1.0315797 , -0.07158865,
            -1.4468901 ,  0.7721667 , -0.3744553 ], dtype='float32')
        self.Mongoloid_Native_American_male_mean_vector = np.array([-0.40189284, -0.63973904,  0.13101521, -0.4185981 ,  1.5349139 ,
            -0.08756147, -0.26069823,  0.8757164 ,  1.2140266 , -0.09210585,
            -0.4217164 , -0.4289724 , -0.25669068,  0.05863088,  0.29506463,
            -0.653083  , -0.29835   , -0.36653918,  0.07599722,  0.5034324 ,
                0.8305373 ,  0.18695787,  0.4693361 ,  0.01056635, -0.18702736,
            -0.69147027,  0.3802049 , -0.09965487, -0.477216  , -0.6045174 ,
            -1.0113262 , -0.22368102, -0.808499  ,  0.16955014, -0.34828988,
            -0.27182585,  0.41594058, -0.5551077 ,  0.01048161, -0.71376616,
            -0.19145599, -0.4766613 , -0.9613913 , -0.45619735, -0.8176966 ,
            -0.49090004, -0.702741  , -0.5697291 ,  0.43443948,  0.3713833 ,
            -1.1730158 ,  1.1658878 , -0.09080632, -1.2889258 , -0.31706852,
            -0.6870504 ,  1.4366953 , -0.3839258 , -0.31171596, -0.25172782,
            -0.527953  ,  0.52054346, -0.25415185,  1.0382857 , -0.47832322,
                0.9223857 ,  1.2725519 ,  0.23979548, -0.05301579, -0.2614567 ,
            -0.50330126, -0.46212253,  0.08559109, -0.8181044 ,  0.5085681 ,
                0.283042  , -0.54713327, -0.49810386, -1.634242  , -0.22681761,
            -1.2216305 ,  0.6281566 ,  0.27589998, -0.2718498 ,  0.30063933,
                0.17166135, -0.5099995 ,  0.5685588 , -0.28864262,  0.77823526,
                0.65699035, -0.33285838, -0.6313924 ,  0.2270515 ,  0.2186604 ,
            -0.3828823 , -0.48353052,  0.03624947, -0.08627138,  0.43051323,
                0.40987682, -0.2841975 , -0.38002717, -0.57125175,  0.7435163 ,
                0.2538678 ,  0.55453706, -0.385002  ,  0.510541  ,  0.16601807,
            -0.02903618, -0.21918866,  0.16362557,  0.2797459 ,  0.5932189 ,
            -0.18211801, -0.1901005 ,  0.23636754,  0.41740465,  0.55267274,
                0.3671995 ,  0.37510556, -1.1034031 , -0.68586457,  0.34438524,
            -1.2737    ,  0.3328396 ,  0.4246048 ], dtype='float32')
        self.Mongoloid_Native_American_female_mean_vector = np.array([-4.70732689e-01, -5.90362847e-01,  3.55930954e-01, -6.45323217e-01,
                1.40005255e+00,  7.78079852e-02,  4.13415015e-01, -5.21140397e-02,
                9.57044482e-01,  2.55603611e-01, -7.56613731e-01, -2.28246137e-01,
            -6.37755215e-01, -1.65122747e-02,  1.16283107e+00, -6.97754323e-01,
            -3.41943651e-01, -9.07212377e-01,  4.72979508e-02,  3.58134508e-01,
                1.29813755e+00, -3.97560358e-01,  1.02536976e+00,  2.05799490e-01,
            -1.91493635e-03, -6.93834245e-01,  7.32030690e-01, -4.87327158e-01,
            -3.64820004e-01, -2.89985597e-01, -6.41485274e-01, -4.13077503e-01,
            -1.11088645e+00,  9.94985938e-01,  3.24523970e-02, -7.48940945e-01,
            -1.72137350e-01, -2.82477260e-01,  2.20279813e-01, -1.02576339e+00,
            -6.06464803e-01, -1.12913921e-01, -1.40641177e+00, -6.63663924e-01,
            -9.66724038e-01, -4.87247944e-01, -8.74303162e-01, -4.39732134e-01,
                3.89061898e-01,  8.30774128e-01, -1.14649951e+00,  7.57423818e-01,
                2.81514227e-01, -1.47391343e+00,  8.80843252e-02, -1.07826877e+00,
                1.64867365e+00, -1.86716869e-01, -6.52616203e-01, -2.39428073e-01,
            -5.13241291e-01,  5.67018151e-01, -6.09990954e-01,  9.83746827e-01,
            -6.69133723e-01,  5.97118378e-01,  8.29021335e-01,  6.47774577e-01,
                1.78133212e-02,  4.06286895e-01, -4.99044001e-01, -5.39867580e-01,
            -3.32177207e-02, -1.31997395e+00,  4.21188533e-01,  4.62475359e-01,
            -5.57215571e-01, -8.41277421e-01, -2.07465267e+00, -3.36293042e-01,
            -1.74370170e+00,  1.10990512e+00,  5.32873392e-01, -5.83563745e-01,
                3.77075851e-01,  5.95758379e-01,  2.79637843e-01,  7.04441607e-01,
            -7.16299891e-01,  4.06664759e-01,  5.95528007e-01, -4.59865004e-01,
            -3.07283044e-01,  4.59089756e-01,  1.24902618e+00, -6.46060348e-01,
            -6.36617482e-01,  6.07513249e-01,  3.41303110e-01,  7.23113418e-01,
                6.22101545e-01, -2.45742038e-01, -7.00723469e-01, -2.62460113e-03,
                9.68563855e-01, -1.22200504e-01,  4.76479232e-01,  4.53382507e-02,
                5.31039476e-01, -4.48151976e-01, -4.69635189e-01, -7.70505309e-01,
            -1.55349910e-01,  1.83235463e-02,  1.36560351e-01,  2.52788484e-01,
            -9.85339656e-02,  6.68992579e-01,  4.02159929e-01,  5.96500695e-01,
                1.12198234e+00,  7.03821778e-01, -9.25340533e-01, -1.42803800e+00,
                3.44466865e-01, -1.60526466e+00, -1.46598682e-01,  7.19100833e-01],
            dtype='float32')
        self.Mongoloid_North_Asian_male_mean_vector = np.array([-0.12314782, -0.8303898 , -1.3750272 , -0.7173154 ,  1.2329545 ,
            -0.6826765 , -0.13718784,  0.0155309 ,  0.41174448, -0.30054745,
            -0.2880168 , -1.6084731 , -0.9928423 , -0.72376984,  0.60676175,
                0.28416643,  0.32807645, -0.93611324, -0.4200564 , -1.1185555 ,
                0.05605506,  0.69732636, -0.38284788, -0.1254233 ,  0.6216888 ,
            -0.14097117,  0.04831424,  0.33286726,  0.02461874,  0.6432417 ,
                0.35797644, -0.6750365 ,  0.22211507, -0.20347592,  0.6157686 ,
                0.4107492 , -0.29848966,  0.03749117,  0.62251246, -0.75793153,
            -0.4938244 ,  0.77668476, -0.40222526, -0.77188814, -0.33407322,
            -0.5084135 , -0.03818622, -0.05670075, -0.57344323,  1.004404  ,
            -0.8054954 ,  1.0283457 ,  0.77603304, -1.2390151 , -0.48024604,
                0.11882783,  0.76682705, -0.00763522,  0.39427072, -0.57610697,
            -0.0789697 , -0.72793597, -0.29482228,  2.0559223 ,  0.29958454,
                0.3192483 ,  0.26972207,  0.19270809,  0.3034308 , -0.94150263,
                0.16869095, -1.1330439 , -0.77045476, -2.6778724 ,  0.18777701,
                0.7145224 ,  0.12679233,  0.57366675, -0.8453158 , -0.8012683 ,
            -1.298728  ,  1.025563  ,  0.18802719,  0.61159897,  0.5521352 ,
            -0.99217486,  0.07854263, -0.16511229, -1.053352  ,  0.33586702,
                0.86039764, -0.2029696 , -0.7616979 ,  0.87363195, -0.05602602,
            -0.47607446, -1.379315  , -0.72857374, -1.0931088 ,  0.9446037 ,
                0.6045912 ,  0.7853233 ,  0.5626118 , -0.33757275, -0.10044844,
                0.25717774, -0.41955796, -0.15842861, -0.5402411 , -0.26291758,
                0.05511042,  0.11936774,  0.29730836,  1.488168  ,  0.6848466 ,
            -0.30368504,  0.2091606 ,  0.2894171 , -0.3384006 ,  1.1852419 ,
                1.4138594 ,  0.3715918 , -0.09951443, -0.3605054 ,  0.17505848,
            -2.1841438 ,  0.44406274, -0.347169  ], dtype='float32')
        self.Mongoloid_North_Asian_female_mean_vector = np.array([-0.6735868 , -1.4503086 , -0.89054406, -1.4116364 ,  0.10451679,
            -0.9892272 , -0.09488251,  0.30589643, -0.87953264, -0.28900853,
                0.16382213, -0.766886  , -1.233063  ,  0.34585527,  0.24809405,
                0.510838  ,  0.9605967 , -1.7266188 ,  0.7837486 , -1.4840248 ,
            -0.30469957, -0.5022975 , -0.7752663 , -0.35126776,  0.72488105,
            -0.29267102, -0.6283024 ,  0.6108326 ,  0.24888428,  0.4769166 ,
            -0.10205466, -0.64102566, -0.19785647,  0.13440518,  0.86816674,
                1.1603543 , -1.1409696 ,  1.1908497 ,  1.0601857 , -1.0586097 ,
                0.10629034,  1.1755496 , -0.8439032 , -0.19221763,  0.23762512,
            -0.5757741 ,  0.06967236,  0.47512865, -1.1798786 ,  0.9122647 ,
            -1.3540623 ,  1.8368238 ,  1.0821431 , -1.685591  , -0.44175544,
                0.3878204 ,  0.38094807,  0.15852961,  1.483331  ,  0.42190486,
                0.6808547 , -0.06468124, -0.8769878 ,  0.6772771 ,  0.07527652,
                0.3255661 ,  0.06223754,  0.44409126,  0.29764518,  0.06488877,
            -0.0189629 , -0.38769403, -1.680439  , -1.988095  , -0.5396033 ,
                1.2045263 ,  0.15618107, -0.29947   , -0.07768212, -0.9373525 ,
            -0.5105118 ,  0.67847115, -0.68153906, -0.29075193,  1.2238224 ,
            -1.8059924 ,  0.3729077 ,  0.1183344 , -1.1202495 ,  0.4306965 ,
                0.16578294,  0.06679308, -0.18931744,  1.2543043 , -0.03992734,
            -0.7797252 , -0.43990007,  0.3495565 , -0.8374569 ,  1.8182898 ,
                1.257339  , -0.22951984,  0.2830589 , -0.29455605, -0.11851121,
                0.8024594 ,  0.4441108 ,  0.02724409, -1.1053144 ,  0.07976118,
                0.58219874,  0.24543491,  0.8425994 ,  0.47205624,  0.04418675,
            -0.90556383,  0.7281212 ,  0.48874807, -0.50007236,  1.1944672 ,
                1.8950243 ,  1.5799224 , -0.67059267,  0.02088278,  0.82363605,
            -1.4732046 ,  0.3894522 , -0.92311364], dtype='float32')
        self.Mongoloid_Southeast_Asian_male_mean_vector = np.array([-4.48874712e-01, -6.53906882e-01, -3.98656458e-01, -6.88266456e-01,
                7.00169265e-01, -4.54566956e-01,  3.46166104e-01, -2.52875030e-01,
                6.98997617e-01, -6.55543506e-01,  3.05340707e-01, -1.11020052e+00,
            -3.35325629e-01, -4.46952671e-01,  2.21051648e-02, -1.41766101e-01,
                1.30571306e-01, -7.49460340e-01, -7.20096845e-03, -5.68999290e-01,
                3.76281351e-01,  5.80192745e-01, -1.52101755e-01, -1.24971345e-01,
                6.88784719e-01,  3.77718240e-01,  7.24050164e-01,  2.75556028e-01,
            -6.26582384e-01,  8.84708911e-02, -2.84404904e-01,  1.07398629e-01,
            -1.17412008e-01,  2.11983249e-01,  8.00002217e-01,  2.75925636e-01,
                1.94870353e-01, -3.89040530e-01,  1.02197433e+00, -7.29601741e-01,
            -6.42574191e-01,  1.06739306e+00, -6.22625947e-01, -1.04861617e+00,
            -8.11676621e-01, -3.40978205e-01, -2.85848558e-01, -5.23705781e-01,
            -2.63303131e-01,  1.39329696e+00, -7.72245884e-01,  7.06380010e-01,
                1.08264911e+00, -1.32638943e+00,  3.45621146e-02, -3.46737611e-03,
                1.06447995e+00, -2.68498473e-02,  7.08005056e-02, -7.40944743e-01,
                8.37552622e-02, -1.11874804e-01, -1.97005540e-01,  1.52876782e+00,
                2.44759724e-01,  6.52136326e-01,  4.32542950e-01,  5.72355986e-01,
                1.22571275e-01,  2.80372612e-02,  2.41713449e-01, -5.70994496e-01,
            -2.77389467e-01, -2.27650595e+00, -1.87151760e-01,  4.58462238e-01,
                1.91789863e-04,  2.45535702e-01, -7.65773833e-01, -6.38622522e-01,
            -1.11022067e+00,  5.21158338e-01,  2.12278157e-01,  5.66975951e-01,
                9.14590180e-01, -1.11454830e-01,  5.97195506e-01,  1.38527319e-01,
            -9.63848293e-01,  3.61569464e-01,  9.15602684e-01,  1.63430706e-01,
            -9.56814885e-01,  6.10057235e-01,  3.77573550e-01,  1.76435828e-01,
            -9.63974476e-01, -3.54110032e-01, -1.00830209e+00,  2.19736382e-01,
                8.62119079e-01,  6.38597131e-01,  6.31024837e-01, -1.10259879e+00,
                8.06777328e-02,  3.84531915e-01, -2.42550939e-01, -7.82920271e-02,
            -2.85472929e-01, -7.63985276e-01,  3.62867266e-01, -4.37563360e-01,
                4.73271042e-01,  1.42660940e+00,  6.38834596e-01,  4.39810187e-01,
            -1.35132402e-01,  6.20725274e-01,  5.75162590e-01,  1.37127852e+00,
                6.30512655e-01,  1.49223238e-01,  1.46252692e-01, -5.77697158e-01,
                8.40231776e-01, -2.03447175e+00,  8.70702624e-01, -9.39563140e-02],
            dtype='float32')
        self.Mongoloid_Southeast_Asian_female_mean_vector = np.array([-0.81328166, -0.8718486 ,  0.12485702, -1.073123  ,  0.00958817,
            -0.34235492,  0.30861416, -0.43640083, -0.07741229, -0.5294789 ,
                0.14685604, -0.24591573, -0.01955572,  0.58020633, -0.31305474,
            -0.1813581 ,  0.28088424, -1.6828228 ,  0.71466756, -0.886654  ,
                0.38366866, -0.17260651, -0.08730088, -0.08626528,  0.29144907,
                0.40193304,  0.6356041 ,  0.27120975, -0.19373092,  0.04738136,
            -0.56265104, -0.08676057, -0.30364427,  0.60299873,  0.73023677,
                0.8404155 , -0.5753664 ,  0.08877679,  0.82943743, -0.4895714 ,
                0.2642885 ,  1.3215868 , -0.4455103 , -0.44488367, -0.43816417,
            -0.50020695, -0.21642451, -0.41067696, -0.3503021 ,  0.67004603,
            -1.0696615 ,  1.026553  ,  1.0895982 , -1.851454  , -0.12746534,
                0.20253277,  0.91470194,  0.28707963,  0.8281249 , -0.39737922,
                0.22216126,  0.14563893, -0.5950643 ,  0.6124431 , -0.6005882 ,
                0.43569145,  0.43279284,  0.7825536 , -0.05639427,  0.6651553 ,
                0.09965937,  0.5334396 , -0.39414474, -1.7737446 , -0.6763009 ,
                0.65959376,  0.3477981 , -0.12351295, -0.58212864, -1.1007087 ,
            -0.9408821 ,  0.5766573 , -0.1423345 , -0.24188974,  0.66780066,
            -0.5828578 ,  0.8261695 ,  0.26885432, -0.77923596,  0.13191389,
                0.33368677,  0.11757298, -0.22954139,  0.8332213 ,  0.9268983 ,
            -0.26053798, -0.37790912,  0.40652704, -0.44901672,  0.8229211 ,
                1.51924   , -0.10754846,  0.32608798, -0.5709875 ,  0.14351493,
                0.5625615 ,  0.4055716 ,  0.04889469, -0.75220716, -0.59240544,
                0.88085383, -0.21016416,  0.79367983,  1.2572694 ,  0.20593579,
                0.32505897,  0.38012165,  0.61519426,  0.41863337,  1.1849996 ,
                0.8648437 ,  0.99293673, -0.11659294, -0.6328038 ,  1.198927  ,
            -1.4412472 ,  1.1814592 , -0.21030673], dtype='float32')
        
        self.Negroid_African_American_male_mean_vector = np.array([-0.37820178, -1.1575993 ,  0.05608376,  0.4637292 , -0.22673336,
                0.75487375,  0.03004402, -0.4750637 ,  0.47918782, -0.24393411,
            -0.6396624 , -1.5578653 , -0.47845632,  0.28473073, -0.22086373,
            -1.2323848 ,  1.1222041 ,  0.1554464 ,  0.9168091 , -0.64434725,
                0.26045942, -0.6832512 ,  1.1998608 , -0.09805585,  0.65558994,
                1.3574046 ,  1.1130985 ,  0.23244886, -1.1065514 ,  0.2524114 ,
            -0.08750652,  0.17644836,  0.0664464 ,  1.083096  ,  1.0036769 ,
                0.6077081 ,  0.36585   , -0.2242771 ,  1.2398446 ,  0.10040192,
            -0.44994083,  1.115627  ,  0.04409897, -1.2225597 ,  1.1543524 ,
                0.5143276 ,  0.08760493,  0.49803853,  0.70464355,  0.45803013,
                0.20745082,  0.33650872,  0.7661032 , -1.491879  ,  0.62257737,
                0.99051553,  0.946247  ,  0.21385495,  1.0207573 , -0.606681  ,
                0.50033647,  0.11846123,  0.1797556 ,  0.91973084, -0.29719153,
                0.57125247, -0.05478683,  1.2738882 , -0.1487619 ,  0.5678957 ,
                0.43604746,  0.03911559,  0.24485847, -1.7688673 , -0.23322722,
                0.43377823, -0.06319942, -0.3666038 , -1.3440181 , -0.20499055,
            -1.7261894 ,  0.480372  ,  0.8385785 ,  0.584134  ,  0.64255774,
                0.28218853,  1.0010393 ,  0.22303335, -0.7663426 , -0.38274592,
            -0.14192131,  1.0801605 , -0.8928526 ,  1.5628573 ,  0.44408798,
            -0.63079435, -0.5881363 , -0.05724404, -1.3827099 ,  1.2533677 ,
                1.7585118 ,  0.46962157,  0.28541055, -0.9722209 , -1.0490105 ,
                0.4746861 , -1.2569472 , -0.12400235, -0.61732846, -1.125909  ,
            -0.15927853, -0.41861957, -0.6867779 ,  1.0415146 ,  0.4859294 ,
                1.1054379 , -0.16699833,  0.18458042,  0.5579967 ,  0.7177306 ,
                0.68743664,  0.37513334,  0.45007396, -1.1558802 ,  0.11562006,
            -1.6609503 ,  2.0149708 , -0.10456313], dtype='float32')
        self.Negroid_African_American_female_mean_vector = np.array([-1.1062676 , -0.81956834,  0.49039578,  0.56299704,  0.17175429,
                0.19724712,  0.2912296 , -1.049376  , -0.34223866, -1.2456771 ,
            -0.5228768 , -0.70714426, -0.22986344,  0.33015963, -0.10821436,
            -0.857458  ,  1.1544147 , -0.17101856,  0.6165689 , -0.9215579 ,
            -0.03700751, -0.7833385 ,  0.9657648 , -0.67519647, -0.05125601,
                1.5928504 ,  0.83626956,  0.6675378 , -0.62845874, -0.30074158,
            -0.03479699,  0.11713377, -0.08084019,  1.1380337 ,  1.1592562 ,
                0.44104925,  0.0897108 , -0.4153615 ,  1.0902729 , -0.05251545,
            -0.5797777 ,  1.2494406 , -0.24940655, -0.76621664,  1.37109   ,
                0.73542076,  0.53329146,  0.4603629 ,  0.7664755 ,  0.14476803,
                0.2549514 ,  0.55986047,  0.908543  , -1.4458933 ,  1.078717  ,
                1.1516528 ,  0.79216146,  0.28605714,  1.5898129 ,  0.09836069,
                0.6650635 ,  0.2728573 , -0.3937227 ,  0.68391   , -0.6759338 ,
                1.1741407 ,  0.33605653,  1.4981511 ,  0.22746138,  1.103893  ,
            -0.0760553 ,  0.5611129 , -0.47297865, -1.3648541 , -0.7945535 ,
                1.4295502 , -0.06575604, -0.2896318 , -1.0470412 , -0.83873004,
            -1.9422716 ,  0.82652724,  0.25370985,  0.47797585,  0.8085393 ,
            -0.5038979 ,  1.3469039 , -0.12485161, -1.0039629 , -0.62325335,
            -0.39408916,  1.0405395 , -0.5470034 ,  0.6133449 ,  0.58581483,
            -0.75937736, -0.19906761,  0.30393428, -0.63156974,  1.189883  ,
                1.6383213 , -0.30309322, -0.3413543 , -0.24187048, -0.31629166,
                1.0758243 , -0.9622471 ,  0.13062747, -0.99068993, -1.0394189 ,
            -0.20161016,  0.02825021, -0.5458461 ,  0.5884352 ,  0.29721782,
                1.8661234 , -0.39633483,  0.25212234,  0.22423431,  0.57015884,
                1.024565  ,  0.67464   ,  0.5468395 , -0.85155356,  0.97469455,
            -1.9882778 ,  1.7685646 , -0.4764801 ], dtype='float32')
        self.Negroid_East_African_male_mean_vector = np.array([-0.5490634 , -0.18377236, -0.2206688 , -0.3704481 ,  0.7029711 ,
                0.14931443,  0.92038125, -0.20324807,  0.66042984, -0.49899894,
            -0.05615835, -1.1173618 , -0.07992574,  0.8122794 , -0.37328902,
            -0.9002775 ,  0.36569995, -0.65338945, -0.04080829, -1.2027831 ,
                0.15613839,  0.2726028 ,  0.6443268 , -0.4876756 ,  0.50804317,
                0.29685798,  0.86748093, -0.05963703, -1.2846173 ,  0.27564263,
            -0.8643756 ,  0.98798275, -0.04679577,  0.6526217 ,  1.0276905 ,
            -0.2729112 ,  0.5832469 , -0.16032906,  1.2653568 , -0.81167614,
            -0.65098995,  1.0659782 , -0.42216784, -0.5775999 , -0.23905806,
                0.1199725 , -0.25709504, -0.8506111 ,  0.5711156 ,  1.5154499 ,
            -0.37787145,  0.44146886,  0.95184976, -2.2485235 ,  0.13488686,
                0.14947583,  1.1365778 , -0.18220091,  0.14176652, -1.0391562 ,
            -0.44630617,  0.4650055 , -0.55196375,  0.88054144,  0.07187532,
                0.21644703, -0.16795285,  0.8619337 ,  0.6492191 , -0.1084434 ,
                0.1918571 ,  0.2812152 , -0.5203156 , -1.9598404 , -0.49150333,
                0.21870609, -0.09188666, -0.9196852 , -0.7587484 , -0.80029213,
            -0.43234187,  1.0024402 ,  0.41782755,  0.64782804,  0.53591615,
                0.6551366 ,  1.1971565 ,  0.24928506, -1.4612223 ,  0.57061726,
                0.33716202,  0.99138993, -1.1073625 ,  0.7258984 ,  0.6480969 ,
                0.7140627 , -0.35449094, -0.12037263, -1.3875306 ,  0.42798576,
                0.5433799 , -0.19718882, -0.31670094, -1.721863  , -0.84609234,
            -0.0287589 , -0.5272519 , -0.4605041 , -0.12865028, -0.86279804,
                0.02164027, -0.76041436, -0.00917017,  1.6959009 ,  0.5780213 ,
                0.7518283 ,  0.19344388,  0.20941468,  0.71861583,  1.4977711 ,
                0.223213  ,  0.20304342,  0.24567871, -0.49725446,  0.23839518,
            -1.5356923 ,  1.1632309 , -0.29073495], dtype='float32')
        self.Negroid_East_African_female_mean_vector = np.array([-0.51362276, -0.12067924,  0.13999978, -0.26204735,  0.13881661,
                0.14840554,  0.6917254 , -0.6207898 , -0.16291013, -0.7732459 ,
            -0.29563016, -0.94646704,  0.14348732,  0.80242825, -0.43993694,
            -0.4698306 ,  0.98136985, -0.9002434 ,  0.85962534, -1.252862  ,
            -0.19363497,  0.11524407,  0.63850754, -0.2171309 ,  0.28925434,
                0.95515716,  0.88173187,  0.483064  , -0.8922636 ,  0.08511454,
            -0.6651094 ,  0.36777848, -0.19466667,  0.9707624 ,  0.9345788 ,
                0.26044336,  0.305003  ,  0.0339237 ,  1.2154504 ,  0.09073579,
            -0.5057836 ,  0.946434  , -0.14027402, -0.32031423,  0.41236085,
                0.38930738,  0.14631529, -0.33609802,  0.69032776,  0.5734996 ,
            -0.26840675,  0.5488337 ,  0.8807577 , -1.8021393 ,  0.12937024,
                0.7574075 ,  0.68932873,  0.2720441 ,  0.8938397 , -0.4626643 ,
            -0.31475076,  0.2684493 , -0.6524383 ,  0.58627695, -0.51519454,
                0.08668651, -0.02935778,  0.8386957 ,  0.33679855,  0.11063106,
                0.07019765,  0.7574126 , -0.0251042 , -1.5604755 , -0.976195  ,
                0.9625994 ,  0.1374143 , -0.28941613, -0.47227535, -1.1426184 ,
            -0.93596953,  0.8360909 ,  0.04638565,  0.2696824 ,  0.58505446,
            -0.1454212 ,  1.4527633 , -0.11722995, -1.1533964 ,  0.19428584,
                0.20982853,  1.1082768 , -0.60700357,  0.34521228,  0.7651746 ,
            -0.04136652, -0.24402022, -0.00964215, -0.9091379 ,  0.7368593 ,
                1.3463266 ,  0.05719564,  0.01589886, -1.1651251 , -0.800917  ,
                0.2917665 , -0.5571397 , -0.16424625, -0.82054794, -1.5037212 ,
                0.17407662, -0.33785212,  0.03290851,  1.4151261 ,  0.4862586 ,
                1.0761915 ,  0.3441605 ,  0.5367434 ,  0.66057575,  1.5552583 ,
                0.3632242 ,  0.58022004,  0.20263824, -0.38442546,  0.59755445,
            -1.3695672 ,  1.7142967 , -0.5308965 ], dtype='float32')
        self.Negroid_South_African_male_mean_vector = np.array([-4.68623251e-01, -6.07594490e-01, -2.66433448e-01, -4.01645675e-02,
                5.92950694e-02,  5.18190563e-01,  3.64213884e-01, -1.72713354e-01,
                6.75209820e-01, -9.97184739e-02, -2.90296704e-01, -1.21341920e+00,
            -1.09051287e-01,  3.20320100e-01, -1.18110180e-01, -8.20010066e-01,
                5.38360655e-01, -3.66140097e-01,  2.62281954e-01, -8.44466329e-01,
                3.34306061e-01, -2.18061611e-01,  9.05569196e-01, -1.06584474e-01,
                5.71731985e-01,  4.84443188e-01,  9.42060649e-01,  1.11288629e-01,
            -1.20729864e+00,  1.35628372e-01, -3.67899507e-01,  4.08926427e-01,
                1.98826388e-01,  9.71717477e-01,  9.99898911e-01, -3.10018659e-04,
                4.39589441e-01, -5.19067645e-01,  1.16689742e+00, -6.35900140e-01,
            -5.40585041e-01,  9.70862746e-01, -1.88522249e-01, -8.20333302e-01,
                3.97143334e-01, -6.30348250e-02,  7.94826299e-02, -7.14706630e-02,
                4.22100008e-01,  9.38592613e-01, -1.64426595e-01,  3.31570327e-01,
                3.97123396e-01, -1.38298726e+00,  2.38633588e-01,  5.80501974e-01,
                1.11155534e+00, -4.70721684e-02,  1.67002469e-01, -7.81871736e-01,
                9.20654386e-02,  3.70848298e-01, -1.48816735e-01,  8.78380120e-01,
                1.94164962e-01,  2.40071014e-01, -2.77582467e-01,  9.71917987e-01,
            -1.82185799e-01,  9.76746157e-02,  3.31534773e-01,  9.06623602e-02,
                3.73979285e-02, -1.72958469e+00, -8.44032690e-02,  9.10627469e-02,
            -5.79737946e-02, -6.58914328e-01, -7.99058616e-01, -4.61818784e-01,
            -1.01895225e+00,  6.46525264e-01,  8.11993778e-01,  5.25270641e-01,
                5.91930211e-01,  3.40227067e-01,  1.05538595e+00,  2.34395936e-01,
            -8.22192788e-01, -1.37485592e-02, -6.22673817e-02,  8.45502853e-01,
            -9.57357585e-01,  1.02916980e+00,  7.37794518e-01,  1.97122380e-01,
            -6.86104655e-01, -7.70655870e-02, -1.45126331e+00,  7.01811433e-01,
                1.18296933e+00,  2.22148851e-01, -2.34547764e-01, -1.10412669e+00,
            -6.76874936e-01,  1.98507726e-01, -8.42877686e-01, -3.37628812e-01,
            -1.23957433e-01, -8.64399135e-01, -2.07792088e-01, -6.33087039e-01,
            -2.15028316e-01,  1.15727556e+00,  2.81642854e-01,  7.19438374e-01,
                8.78376961e-02,  1.59541994e-01,  6.00199163e-01,  8.56968582e-01,
                4.55542564e-01,  2.02864021e-01,  5.29387355e-01, -4.72603023e-01,
                3.85208935e-01, -1.55662763e+00,  1.45902169e+00, -6.27946481e-02],
            dtype='float32')
        self.Negroid_South_African_female_mean_vector = np.array([-0.5845043 , -0.42662764,  0.21518485, -0.19498047, -0.19318907,
                0.6220039 ,  0.5960162 , -0.621387  ,  0.21576765, -0.39011124,
            -0.4909435 , -0.89001596,  0.31012806,  0.53245795, -0.18604526,
            -0.7074712 ,  0.8760538 , -0.7662047 ,  0.91354454, -1.0485315 ,
                0.07485639, -0.26063275,  0.94715846,  0.2059805 ,  0.4079415 ,
                0.93468696,  1.1898218 ,  0.33515567, -1.0041358 , -0.02160209,
            -0.5445136 ,  0.1529078 ,  0.0552604 ,  1.0349936 ,  1.08918   ,
                0.24540034,  0.21096441, -0.18064678,  1.1306365 ,  0.02038031,
            -0.3774968 ,  1.0977992 , -0.08910287, -0.6300101 ,  0.35249168,
                0.17640209,  0.14437743, -0.11422479,  0.63733333,  0.5209602 ,
            -0.09466132,  0.57015455,  0.72548985, -1.6041558 ,  0.30239034,
                0.91427165,  0.84238654,  0.11246212,  0.5529927 , -0.58618027,
                0.15654685,  0.3849416 , -0.46627015,  0.71989965, -0.3120931 ,
                0.33000728, -0.02849666,  1.1803789 , -0.0045951 ,  0.49163216,
                0.22515658,  0.6675216 ,  0.5588107 , -1.7483164 , -0.48267207,
                0.61797416,  0.08285488, -0.37763113, -0.87251043, -0.8374376 ,
            -1.340642  ,  0.87030333,  0.44015294,  0.33374375,  0.6679689 ,
                0.15296337,  1.6109692 , -0.04578256, -0.8696251 ,  0.09085499,
                0.03928526,  1.0363716 , -0.5472888 ,  0.77522975,  0.9623693 ,
                0.09034959, -0.38757902,  0.18761198, -1.1582426 ,  0.8469119 ,
                1.639288  ,  0.3085804 ,  0.06454507, -0.9178767 , -0.6353887 ,
                0.22350772, -0.8188842 ,  0.03089317, -0.3724254 , -1.4442203 ,
            -0.08305078, -0.4029823 , -0.14183472,  1.2796566 ,  0.13451183,
                1.1376785 ,  0.11417065,  0.568552  ,  0.8485352 ,  0.9909747 ,
                0.5333516 ,  0.38139933,  0.44107324, -0.6070303 ,  0.7869929 ,
            -1.5594084 ,  1.8418963 , -0.24419478], dtype='float32')
        self.Negroid_West_African_male_mean_vector = np.array([-4.4302702e-01, -6.1989701e-01, -2.3827335e-01, -5.0125718e-02,
                2.5261584e-01,  1.1254462e-01,  4.1512641e-01, -6.3861388e-01,
                1.7730202e-01, -3.2882184e-01,  6.2407850e-04, -1.5122949e+00,
            -2.5793403e-01,  9.5348299e-02, -3.5047251e-01, -4.5699686e-01,
                1.0863643e+00, -6.2445749e-02,  5.2187377e-01, -1.0173666e+00,
                1.4845370e-01,  5.8221318e-02,  1.0099601e+00, -1.9466503e-01,
                4.4977784e-01,  9.9588615e-01,  8.5156548e-01,  4.7819105e-01,
            -1.0860718e+00,  3.6500698e-01, -4.5338011e-01,  5.4326785e-01,
            -2.0047024e-01,  1.0407962e+00,  1.1789159e+00,  3.5255259e-01,
                5.4039299e-01,  8.6145103e-04,  1.3404541e+00, -6.9045343e-02,
            -6.3714349e-01,  8.5849607e-01, -2.6062321e-02, -7.9684329e-01,
                8.2392561e-01,  2.1086641e-01,  1.2798539e-01, -1.9047108e-01,
                9.7076499e-01,  9.0607464e-01, -2.8388721e-01,  4.9400710e-02,
                6.9242156e-01, -1.5796415e+00, -7.4439300e-03,  8.8131416e-01,
                8.9838421e-01,  3.1423423e-01,  6.9987237e-01, -9.2229843e-01,
            -3.3210441e-01,  1.6489704e-01, -2.7683136e-01,  1.0226431e+00,
            -2.3592016e-01,  3.0265206e-01,  7.3825322e-02,  6.6979367e-01,
                4.0740013e-01, -1.7287330e-01,  1.9844580e-01,  1.3405617e-01,
                1.4027575e-01, -1.5772810e+00, -5.1642716e-01,  2.7832702e-01,
            -1.4956497e-01, -4.5885640e-01, -9.1218889e-01, -8.1556827e-01,
            -1.0806148e+00,  5.0129545e-01,  3.4937856e-01,  5.9494525e-01,
                5.3163785e-01,  3.8491097e-01,  1.1139659e+00,  2.4477610e-01,
            -1.1549060e+00,  4.0482864e-01,  3.5027111e-01,  1.2633446e+00,
            -9.0627396e-01,  9.0730011e-01,  5.4039586e-01, -7.8524947e-02,
            -5.0756353e-01, -4.8591813e-01, -1.3175375e+00,  7.3707861e-01,
                1.0559700e+00,  3.3327374e-01,  2.2249472e-01, -1.5286447e+00,
            -7.8413051e-01,  3.0119535e-01, -7.5688851e-01, -2.2729599e-01,
            -5.8598155e-01, -1.4179208e+00,  2.0224372e-01, -4.0040198e-01,
            -2.5103649e-01,  1.7087797e+00,  8.2489604e-01,  9.2842990e-01,
                3.8617092e-01,  2.6004678e-01,  4.9643651e-01,  1.4057881e+00,
                2.6180840e-01,  2.6356679e-01,  4.3300033e-01, -7.2381133e-01,
            -5.4204833e-02, -1.5259638e+00,  1.7601925e+00, -6.5053809e-01],
            dtype='float32')
        self.Negroid_West_African_female_mean_vector = np.array([-0.32335502, -0.39746588,  0.01812346,  0.20215364, -0.15184064,
                0.42243034,  0.24410419, -0.81628597, -0.09418444, -0.52545285,
            -0.1631065 , -1.4603413 ,  0.14779438,  0.23558803, -0.83008385,
            -0.5531245 ,  1.2918371 , -0.34281945,  1.5249305 , -0.8202669 ,
                0.22789197, -0.04253815,  0.757194  ,  0.05556358,  0.3267498 ,
                1.5625752 ,  0.9403714 ,  0.59775835, -1.0512469 , -0.17990775,
            -0.7379453 ,  0.42522877, -0.68192136,  0.97336054,  1.1298797 ,
                0.6402997 ,  0.33147973,  0.04852775,  1.3806378 ,  0.9177796 ,
            -0.19356638,  0.8393833 ,  0.0706443 , -0.53873813,  0.4374512 ,
                0.5041122 ,  0.22660246,  0.07735781,  1.1551154 ,  0.14740035,
            -0.39539605,  0.37662813,  0.7896987 , -1.2392961 ,  0.24734437,
                1.1265036 ,  0.7524308 ,  0.27681744,  0.9936615 , -0.55006945,
            -0.36477664, -0.13354373, -0.07838377,  0.6285797 , -0.7315091 ,
                0.07249457,  0.26789823,  0.92367667,  0.33394718, -0.01608323,
            -0.15142858,  0.8295841 ,  0.38353714, -1.3393219 , -0.984906  ,
                0.8136784 ,  0.10447991,  0.26267943, -0.94539815, -1.034375  ,
            -1.1764834 , -0.06859832,  0.07736009,  0.11338985,  0.64280725,
            -0.05561215,  0.93628293,  0.00861282, -1.0048119 ,  0.22999947,
                0.7119683 ,  1.0075858 , -0.540814  ,  0.5682824 ,  0.5661386 ,
            -0.3765666 , -0.10701339, -0.28573066, -0.75876415,  0.6563715 ,
                1.5998063 ,  0.7370513 ,  0.68035364, -1.2990314 , -0.79553235,
                0.21034864, -0.576225  ,  0.0349782 , -1.1012427 , -2.141863  ,
                0.63330644, -0.26154318, -0.15456274,  1.5299697 ,  0.5716344 ,
                1.1085491 ,  0.33097643,  0.7637963 ,  0.99259806,  1.7961848 ,
            -0.08271114,  0.4632337 ,  0.25769773, -0.7936114 ,  0.29341942,
            -1.3467323 ,  2.0928528 , -0.39545184], dtype='float32')
        
        self.race_male_vector_list = {'Northern_European' : self.Caucasian_Northern_European_male_mean_vector, 
                                      'Semitic' : self.Caucasian_Semitic_male_mean_vector, 
                                      'Southern_European': self.Caucasian_Southern_European_male_mean_vector, 
                                      'West_Asian' : self.Caucasian_West_Asian_male_mean_vector,
                                      'Central_Asian' : self.Mongoloid_Central_Asian_male_mean_vector,
                                      'Native_American' : self.Mongoloid_Native_American_male_mean_vector,
                                      'North_Asian' : self.Mongoloid_North_Asian_male_mean_vector,
                                      'Southeast_Asian' : self.Mongoloid_Southeast_Asian_male_mean_vector,
                                      'African_American' : self.Negroid_African_American_male_mean_vector,
                                      'East_African' : self.Negroid_East_African_male_mean_vector,
                                      'South_African' : self.Negroid_South_African_male_mean_vector,
                                      'West_African' : self.Negroid_West_African_male_mean_vector}
        self.race_female_vector_list = {'Northern_European' : self.Caucasian_Northern_European_female_mean_vector, 
                                      'Semitic' : self.Caucasian_Semitic_female_mean_vector, 
                                      'Southern_European': self.Caucasian_Southern_European_female_mean_vector, 
                                      'West_Asian' : self.Caucasian_West_Asian_female_mean_vector,
                                      'Central_Asian' : self.Mongoloid_Central_Asian_female_mean_vector,
                                      'Native_American' : self.Mongoloid_Native_American_female_mean_vector,
                                      'North_Asian' : self.Mongoloid_North_Asian_female_mean_vector,
                                      'Southeast_Asian' : self.Mongoloid_Southeast_Asian_female_mean_vector,
                                      'African_American' : self.Negroid_African_American_female_mean_vector,
                                      'East_African' : self.Negroid_East_African_female_mean_vector,
                                      'South_African' : self.Negroid_South_African_female_mean_vector,
                                      'West_African' : self.Negroid_West_African_female_mean_vector}
        self.model = tf.keras.models.load_model(model_path)
        self.mp_face_detection = mp.solutions.face_detection
        self.margin = 0.15  # Adjust this value to change the cropping margin
    def get_face(self, path:str) :
        image_list = []
        img = cv2.imread(path)
        with self.mp_face_detection.FaceDetection(model_selection=1, min_detection_confidence=0.5) as face_detection:
                face = face_detection.process(cv2.cvtColor(img, cv2.COLOR_BGR2RGB))
                try :
                    if face.detections:
                        for i, detection in enumerate(face.detections):
                            # Get bounding box coordinates
                            box = detection.location_data.relative_bounding_box
                            ih, iw, _ = img.shape
                            x, y, w, h = int(box.xmin * iw), int(box.ymin * ih), int(box.width * iw), int(box.height * ih)

                            # Calculate margins for x, y, w, h
                            mx = int(w * self.margin)
                            my = int(h * self.margin)

                            # Crop the face with margins
                            face_image = img[y+my:y+h-my, x+mx:x+w-mx]
                            if face_image.size != 0:
                                # Resize the image to 160x160
                                face_image = cv2.resize(face_image, (160, 160))
                                face_image = np.expand_dims(face_image, axis=0)  # Add batch dimension
                                face_image = face_image.astype('float32') / 255  # Normalize to [0,1]
                                image_list.append(face_image)
                    else :
                        print(f'cant find face')
                except :
                    print('error')
                        
        return image_list
    def get_embedded_face(self, image) : 
        embedded = self.model.predict(image)[0]
        return embedded
    def get_face_race(self, image, gender:int):
        distance_list = {}
        if gender == 0:
            vector_list = self.race_male_vector_list
        elif gender == 1:
            vector_list = self.race_female_vector_list

        #  
        for i in vector_list.keys():
            distance = np.linalg.norm(image - vector_list[i])
            distance_list[i] = distance

        #     
        max_distance = max(distance_list.values())
        min_distance = min(distance_list.values())

        #     
        similarity_percentage_dict = {}
        for i, distance in distance_list.items():
            normalized_distance = (distance - min_distance) / (max_distance - min_distance)
            similarity_percentage = (1 - normalized_distance) * 100
            similarity_percentage_dict[i] = similarity_percentage

        #    
        sorted_similarity = sorted(similarity_percentage_dict.items(), key=lambda x: x[1], reverse=True)

        return dict(sorted_similarity)
